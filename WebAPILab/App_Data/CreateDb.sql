DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'WebAPILab.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201910012233441_Initial'
BEGIN
    CREATE TABLE [dbo].[Customers] (
        [Id] [int] NOT NULL IDENTITY,
        [CustomerId] [int] NOT NULL,
        [CustomerName] [nvarchar](30),
        [CustomerEmail] [nvarchar](25),
        [MobileNo] [float] NOT NULL,
        [TransactionIds] [nvarchar](max),
        CONSTRAINT [PK_dbo.Customers] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Transactions] (
        [Id] [int] NOT NULL IDENTITY,
        [TransactionId] [int] NOT NULL,
        [TransactionDateTime] [datetime] NOT NULL,
        [Amount] [float] NOT NULL,
        [CurrencyCode] [nvarchar](3),
        [Status] [int] NOT NULL,
        [Customer_Id] [int],
        CONSTRAINT [PK_dbo.Transactions] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_Customer_Id] ON [dbo].[Transactions]([Customer_Id])
    ALTER TABLE [dbo].[Transactions] ADD CONSTRAINT [FK_dbo.Transactions_dbo.Customers_Customer_Id] FOREIGN KEY ([Customer_Id]) REFERENCES [dbo].[Customers] ([Id])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201910012233441_Initial', N'WebAPILab.Migrations.Configuration',  0x1F8B0800000000000400ED5ADB6EE336107D2FD07F10F4D416592B171468037B17A99314C6E68638BBED5B404B63872845A92415D828FA657DE827F5173AD495A2645972B2DBA228F26251C3C399E199E17094BFFEF873FC6E1D32E71984A4119FB847A343D701EE4701E5AB899BA8E59BEFDC776FBFFC627C11846BE7632177A2E570269713F749A9F8D4F3A4FF042191A390FA2292D1528DFC28F4481079C78787DF7B47471E20848B588E33BE4FB8A221A40FF8388DB80FB14A08BB8E0260321FC737F314D5B92121C898F830717F82C5D9DDEC8A2C46E76757AE73C6284125E6C096AE43388F1451A8E2E90709732522BE9AC73840D8C32606945B12262157FDB412EF6BC5E1B1B6C2AB2616507E2255140E043C3AC9DDE2D9D3F772AE5BBA0D1D77810E561B6D75EABC893B4D9700E13AF662A75326B4A0E9DB6C1F46C5A403A77C7550B200C9A2FF0E9C69C2542260C2215182B003E72E5930EABF87CD43F40BF0094F18339543F5F05D6D0087EE441483509B7B58E62ACF02D7F1EAF33C7B6239CD98931933E3EAE4D8756E7071B26050EEBD61F85C45027E040E822808EE885220B8C680D47B8DD5ADB50AEFEC5EB31F8E7E2A9090BC1882AE734DD657C057EA09830E63EE92AE21280672F00F9C62C0E21C2592DE6B5D8484B28EC58EBF7D85C5AEA30565701315EB9C47480C18EC9F0741B824BEDEB259203B94C69FFB687D439EE92A65C4F68571D97B60A9907CA2719671CAF878AC4B5E8A28BC8F98E1EE9AC0E33C4A84AFB73AEA927A206205AAAEEDD8AB02BB33DC0DA441116FCCFB3FE87792F165716F409DA32E0FB40AFFEA7920E65918E1D9FAC2809B26426015B0992227BA12D22BA48839EE4A52C5B40E2AC32DC5DB4EFDB7C74412B64744013B93978CACAAB2A04F9C60AD2215E14A8E347E53D957881AF46000826DD0DF26BDEA7EBC86700122B7ED26E2A8FE47C2127C386CF8BC267B89891F8252FAA85B7A4AB03433E58FBBE5E789EF8394A5F84973AFB25D3107CFA48C7C9ABADC3AA6EA89B5BEEE050F9C5E59B6A25655045DE346D0185D8FC441978D464D3FECC22FF2733B75ED25BEB11D6118DDCCE4C83245282FDD8AF9802C88043D0E6BD542552C7873B6CA3CF26C6B34EE1C94E561DCAA2A7C1A6E6AB8A40E523FF61A383577585086F94DA5ACF3D490ED3C78EDD3A52F434AB36A6EF186C2158430E0EA76D8E75ADD072D29ADA4417523F2B22B517175F2B6DC9DC6D7248E31811877A97CC4996717A9E99BF9F06B46986178BE6CB96D94DA962BE1514B5660BDC5A551D34B2AA42A68ED3AD3206C88D9A4DFC2C562359BD7CDED2BE859CCD0BFB359B55B65C57F0BA272E225DA1562C1909A082DFC694E4D6FB38411D152BC4C2396847C5B01D435DBBC839828E6F870B4EC26D28697BD198E98DF37DA20F357FD31AB6B8509578DF647B26F16269EFDAE893AF62C36D88CF31A94B31280CDE15E0CDF91F2FA92DC4CCEC379DE39FBD350DDAABCB7EED59E9855C9BD05B912E88F5F94E3266431362488CC7ABC1E43E69BFE8845056C6215639F9FE8F573B03D9F5B25C1AED46D890FA0AF3EE6B724B1D6EAA1E9AD5EDC2F31DB08AB1D562AB1AF7E7939B2A77E83D5C2533AA069093F93FABE56DEAA7A5A6D97434DA634AA225BA4E469591D5955D038AF4876B7991B254A26E23A68FE330D747932DF4805E1480B8CE6BFB229A3A0C3BA10B8269C2E41AAEC62E71E1F1E1D5BEDEA7F4FEBD89332603DFBC79FBDA743B55777766DF6ECB95ACBBC42E7963F13E13F11D1E8DD56D87B376A5BB175AB7618B6DD975DB2880C37BEBD2D5BA8F85548D65F772BB65733F3BF41BFD62EE23E0CECE82106F8AC5EDE43DC8F1C6D2DC4F6C8184ADE7AC7F02551FB68B9BED15399F100D613F7B774DEA933FBF9D1987AE0DC0A4CF3A7CEA1F3FB7E3C7FADB6D76BB4B86AAD9ABD3A5AFAB32E2C41E888202C6D930A3CA51BB5E29DA0DCA73161B615CD42A54F286BF79690F69B738881EB186DB1B2CF723B8AB412DE4A2EBBFC30B0F9D76C97F46BED7576F6B27A06B3C4421F031975B736BFBA1A7FBBFA7E6D0B75B6C5FE99CE606B17B0B309D8E283C6DDE293B4FC9A452C52CEF88F0AA4BDA4AB0A4297E61CFC1AD94A99195F4605F12D8D0A11BB7A0045F06C216742D125DA89AF75CB3FFD3A9477FD2FC20504337E9BA838516832840B56FBB2A663A76BFDB4AF59D7797C1BA77BF91A26A09A541F8FB7FC8784B2EAE3C665CBD7A52D103A28F38220FDF6A30B83D5A644CABEC8F401CADD57E6920708638660F296CFC933ECA3DB070957B022FEA6B88B6C07D9BD1175B78FCF29590912CA1CA39A8F8FC8E1205CBFFD1BF87A107158240000 , N'6.1.3-40302')
END

