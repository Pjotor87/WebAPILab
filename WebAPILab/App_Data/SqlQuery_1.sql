DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'WebAPILab.DAL.DatabaseContext'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201910011322193_InitialCreate'
BEGIN
    CREATE TABLE [dbo].[Customers] (
        [CustomerId] [int] NOT NULL IDENTITY,
        [CustomerName] [nvarchar](30),
        [CustomerEmail] [nvarchar](25),
        [MobileNo] [float] NOT NULL,
        [TransactionIds] [nvarchar](max),
        CONSTRAINT [PK_dbo.Customers] PRIMARY KEY ([CustomerId])
    )
    CREATE TABLE [dbo].[Transactions] (
        [Id] [int] NOT NULL IDENTITY,
        [TransactionId] [int] NOT NULL,
        [TransactionDateTime] [datetime] NOT NULL,
        [Amount] [float] NOT NULL,
        [CurrencyCode] [nvarchar](3),
        [Status] [int] NOT NULL,
        [Customer_CustomerId] [int],
        CONSTRAINT [PK_dbo.Transactions] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_Customer_CustomerId] ON [dbo].[Transactions]([Customer_CustomerId])
    ALTER TABLE [dbo].[Transactions] ADD CONSTRAINT [FK_dbo.Transactions_dbo.Customers_Customer_CustomerId] FOREIGN KEY ([Customer_CustomerId]) REFERENCES [dbo].[Customers] ([CustomerId])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201910011322193_InitialCreate', N'WebAPILab.DAL.DatabaseContext',  0x1F8B0800000000000400CD5ACD6EE33610BE17E83B083AB545D6721C1468037B17A9131746E32488B3DBDE025A1A3B44294A25A9C046D127EBA18FD457E850FFA26459F27A778B5C2C6AF87138FCE687A3FCFBF73FE3775B9F59AF20240DF8C43E1F0C6D0BB81B78946F2676A4D66F7EB0DFBDFDFAABF18DE76FAD0F99DC8596C3995C4EEC17A5C24BC791EE0BF8440E7CEA8A40066B357003DF215EE08C86C31F9DF3730710C2462CCB1A3F465C511FE2077C9C06DC855045842D020F984CC7F1CD3246B5EE880F32242E4CEC5F6175F530BF25ABC1F5D5AD6D5D314A508925B0B56D11CE034514AA78F95EC25289806F96210E10F6B40B01E5D684494855BF2CC4BBEE6238D2BB708A8919941B4915F83D01CF2F52B338E6F4A38C6BE76643C3DDA081D54EEF3A36DEC49EC64B80B02D73B1CB29135AB06CDBE41C06D9A4332B7F7596B300C9A2FFCEAC69C4542460C2215282B033EB215A31EAFE02BBA7E077E0131E3156560ED5C37795011C7A10410842ED1E616DA83CF76CCBA9CE774C807C7AC3DC647373AE2E46B67587CA9015839C0B25432C5520E067E0208802EF812805028F72EE416CCD9A167BD6D44FD9AA48427425DB5A90ED2DF08D7A41E741DF99D12D78D940AAC87B4ED1F1708E1211745DEBC62794B52C36FAFE048B2D821565701764EB5C0778C0D060CB76982741B824AE36F5DC932D4AE3CF63B4BE23AF74139FE4FE8571D94760B1907CA1611239729E3F57256722F01F0356327745E0791944C2D5471DB4493D11B10155D576EC140EDAEAB625A45E9E5B9AF7659CF718A7FD9CCE5A21E3A1653B435DA32E4FB470FFE2B927E6951F608EFC48879B46426036DF4D91136D01E904216289A712153EAD9DAA6496EC6DABFEFB7D22F29B3D22839DCB19239B22BD77F113AC39A4225CC9BA9E277018349E0782EDD0D46566554DB8007F0522DDD65DC051F30F8445F830AC99BB223BC3980F5E2E7DDE2E3D25585D95E547EDF2CBC87541CA5CFCA27E4CC9819407AFA40C5C1A5BDBC850D5985A5DF7867B56A7005BB0AAA8631678103444D32367D0648341DD0E87F0B3D0DCCC5A7389EF4C4394365D0FE248304528CFCD8AA180AC88043D0E5BD5C052AC5953A2CAD4E9CCDD68DC2528C3C2785485E7D4CC54334915A49AF16A3815731850A5EDD79532526949B635E79A89A52B43F26D55CCE2F485CB085182ABEEC34C69551B3444B39C06C5A5C6496E35D9EDC7D973FD192F48186200295D87D2116B99DC85A66F96FD6F0A7E82E1B8B2E1C2906B9BAF8459966CC0788B4BA3A6332AA4CA686D5B53CFAF8999A4DFC3C56C3593D7F5E3CBE899CDD0BF9359958B61C17F03A230E20CF7E563AD106F111AF8539F1A5F480923A2E5B2310D58E4F34317982E68C935A2092F79D31F31BD2C3441A6AFBA63167782325C31DA1DC9BC1694F1CC7775D4B1639CA7C919A7461AC3854D1676E2E881A0D595A6E5F0DA9FA9ADB3F799DB24693F721A65F3DEB33A12B3A897F7201702DDF1B35ABA0C998DF571A272315DF5A1F29BEE8859F95AC6CAC63E3FD1AB99AC39221B49FD50F035C47BD05727EA3D41AC31FFD7AD7554A07E6E8BD8DA80B952C7EA9B16181DF5EDE2ABAD6A61DEF5685C94CFA5BE7CE557A49EBB370B9D3A836AF58E2992F337AF7B8CFA669CD61A877BC0B5E22311B12D34C32BF574E1B1DC4905FE400B0C967FB029A3A0DD3D1358104ED720557265B347C3F391D14BFEFFF4751D293DD6B1B9FBC5BBAC545BF9606BA6771FA3DE58E5AF44B82F44D45AAB05F6D17DD4466CDD49ED876DB64DD72C20EA445DD34CC56F7CB2FDB65DB1A37A8D9FBDE3F74988D3D8E48B573A5D8BCFC367F5F12DBEE3C8D1D4E16BF68CBEE4AD36F48EB159635A29C1D5FA1F73EEC17662FF19CFBFB4E6BF3D37409C59F70203F8A535B4FE3A8EF7A76A559DA22D5569AF1CD585D25F53610D427B086171575360FEAD55870F827297868499BBA897227D728436730E6DBEB98610B8F6DD86DDF659F64059962F63049F4376E9D9C0ABB73CBAB5E75ABB7349E5825164A5D34442E5BD0DACB6E6DDA1DE5DD342ADADAD2FD3DD6BECE4B536F21A6C50BB5D7C92B65DBD5C45CA95FEB101E92FE9A680D0C53807B742B65C66CED741E60086469988595D8022987BC89550748DFBC4D7BA6D1F7FDC493BF737FE0ABC39BF8F541829DC32F82B56F930A67DA76DFDB83759D5797C1FC667798A2DA09A54A7CF7BFE534459F18162D6F071680F8476CAB46088BFDFE8C261B3CB9192AF2A5D8052F3E5B1E409FC902198BCE74BF20AC7E8F65EC22D6C88BBCB6E1DFB410E1F44D5ECE36B4A3682F832C528E6E32372D8F3B76FFF0318D753E9DF230000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201910011408486_Initial'
BEGIN
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201910011408486_Initial', N'WebAPILab.DAL.DatabaseContext',  0x1F8B0800000000000400CD5ACD6EE33610BE17E83B083AB545D6721C1468037B17A9131746E32488B3DBDE025A1A3B44294A25A9C046D127EBA18FD457E850FFA26459F27A778B5C2C6AF87138FCE687A3FCFBF73FE3775B9F59AF20240DF8C43E1F0C6D0BB81B78946F2676A4D66F7EB0DFBDFDFAABF18DE76FAD0F99DC8596C3995C4EEC17A5C24BC791EE0BF8440E7CEA8A40066B357003DF215EE08C86C31F9DF3730710C2462CCB1A3F465C511FE2077C9C06DC855045842D020F984CC7F1CD3246B5EE880F32242E4CEC5F6175F530BF25ABC1F5D5AD6D5D314A508925B0B56D11CE034514AA78F95EC25289806F96210E10F6B40B01E5D684494855BF2CC4BBEE6238D2BB708A8919941B4915F83D01CF2F52B338E6F4A38C6BE76643C3DDA081D54EEF3A36DEC49EC64B80B02D73B1CB29135AB06CDBE41C06D9A4332B7F7596B300C9A2FFCEAC69C4542460C2215282B033EB215A31EAFE02BBA7E077E0131E3156560ED5C37795011C7A10410842ED1E616DA83CF76CCBA9CE774C807C7AC3DC647373AE2E46B67587CA9015839C0B25432C5520E067E0208802EF812805028F72EE416CCD9A167BD6D44FD9AA48427425DB5A90ED2DF08D7A41E741DF99D12D78D940AAC87B4ED1F1708E1211745DEBC62794B52C36FAFE048B2D821565701764EB5C0778C0D060CB76982741B824AE36F5DC932D4AE3CF63B4BE23AF74139FE4FE8571D94760B1907CA1611239729E3F57256722F01F0356327745E0791944C2D5471DB4493D11B10155D576EC140EDAEAB625A45E9E5B9AF7659CF718A7FD9CCE5A21E3A1653B435DA32E4FB470FFE2B927E6951F608EFC48879B46426036DF4D91136D01E904216289A712153EAD9DAA6496EC6DABFEFB7D22F29B3D22839DCB19239B22BD77F113AC39A4225CC9BA9E277018349E0782EDD0D46566554DB8007F0522DDD65DC051F30F8445F830AC99BB223BC3980F5E2E7DDE2E3D25585D95E547EDF2CBC87541CA5CFCA27E4CC9819407AFA40C5C1A5BDBC850D5985A5DF7867B56A7005BB0AAA8631678103444D32367D0648341DD0E87F0B3D0DCCC5A7389EF4C4394365D0FE248304528CFCD8AA180AC88043D0E5BD5C052AC5953A2CAD4E9CCDD68DC2528C3C2785485E7D4CC54334915A49AF16A3815731850A5EDD79532526949B635E79A89A52B43F26D55CCE2F485CB085182ABEEC34C69551B3444B39C06C5A5C6496E35D9EDC7D973FD192F48186200295D87D2116B99DC85A66F96FD6F0A7E82E1B8B2E1C2906B9BAF8459966CC0788B4BA3A6332AA4CA686D5B53CFAF8999A4DFC3C56C3593D7F5E3CBE899CDD0BF9359958B61C17F03A230E20CF7E563AD106F111AF8539F1A5F480923A2E5B2310D58E4F34317982E68C935A2092F79D31F31BD2C3441A6AFBA63167782325C31DA1DC9BC1694F1CC7775D4B1639CA7C919A7461AC3854D1676E2E881A0D595A6E5F0DA9FA9ADB3F799DB24693F721A65F3DEB33A12B3A897F7201702DDF1B35ABA0C998DF571A272315DF5A1F29BEE8859F95AC6CAC63E3FD1AB99AC39221B49FD50F035C47BD05727EA3D41AC31FFD7AD7554A07E6E8BD8DA80B952C7EA9B16181DF5EDE2ABAD6A61DEF5685C94CFA5BE7CE557A49EBB370B9D3A836AF58E2992F337AF7B8CFA669CD61A877BC0B5E22311B12D34C32BF574E1B1DC4905FE400B0C967FB029A3A0DD3D1358104ED720557265B347C3F391D14BFEFFF4751D293DD6B1B9FBC5BBAC545BF9606BA6771FA3DE58E5AF44B82F44D45AAB05F6D17DD4466CDD49ED876DB64DD72C20EA445DD34CC56F7CB2FDB65DB1A37A8D9FBDE3F74988D3D8E48B573A5D8BCFC367F5F12DBEE3C8D1D4E16BF68CBEE4AD36F48EB159635A29C1D5FA1F73EEC17662FF19CFBFB4E6BF3D37409C59F70203F8A535B4FE3A8EF7A76A559DA22D5569AF1CD585D25F53610D427B086171575360FEAD55870F827297868499BBA897227D728436730E6DBEB98610B8F6DD86DDF659F64059962F63049F4376E9D9C0ABB73CBAB5E75ABB7349E5825164A5D34442E5BD0DACB6E6DDA1DE5DD342ADADAD2FD3DD6BECE4B536F21A6C50BB5D7C92B65DBD5C45CA95FEB101E92FE9A680D0C53807B742B65C66CED741E60086469988595D8022987BC89550748DFBC4D7BA6D1F7FDC493BF737FE0ABC39BF8F541829DC32F82B56F930A67DA76DFDB83759D5797C1FC667798A2DA09A54A7CF7BFE534459F18162D6F071680F8476CAB46088BFDFE8C261B3CB9192AF2A5D8052F3E5B1E409FC902198BCE74BF20AC7E8F65EC22D6C88BBCB6E1DFB410E1F44D5ECE36B4A3682F832C528E6E32372D8F3B76FFF0318D753E9DF230000 , N'6.1.3-40302')
END

